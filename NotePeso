GlooMaps: https://www.gloomaps.com/q6WqD9sT6N


 #[Route('/new', name: 'app_reservation_new', methods: ['GET', 'POST'])]
    public function new(EntityManagerInterface $entityManager,PrestationRepository $prestationRepository, SessionInterface $session, ReservationRepository $reservationRepository, Request $request): Response 
    {
        $user = $this->getUser();
        
       

        $reservation = new Reservation();
        $reservation->setUser($user);
       
        
        
        //ceer un formulaire de reservation 
        $form = $this->createForm(ReservationType::class, $reservation);
        $form->handleRequest($request);
        
        if ($form->isSubmitted() && $form->isValid()) {
            //enrengistre la nouvelle reservation en BDD
            $entityManager->persist($reservation);
            $entityManager->flush();
            
            return $this->redirectToRoute('app_main_calendar', [], Response::HTTP_SEE_OTHER);
        }
        
        return $this->render('reservation/new.html.twig', [
            'reservation' => $reservation,
            'form' => $form,
            'prestation' => $prestationRepository,
        ]);
    }
       
        
      
        #[Route('/creneaux', name: 'app_reservation_creneaux', methods: ['POST'])]
        public function creneauxHorairesAction(Request $request): JsonResponse
        {
            $selectedDate = $request->request->get('selectedDate');
    
            // Utilisez Doctrine pour interroger la base de données et obtenir les rdv pour la date sélectionnée
            $repository = $this->getDoctrine()->getRepository(RendezVous::class);
            $rdv = $repository->findBy(['date' => new \DateTime($selectedDate)]);
    
            // Vous avez maintenant la liste des rdv pour la date sélectionnée dans la variable $rdv
    
            // Transformez $rdv en un format adapté pour la réponse JSON (par exemple, en un tableau de données)
            $rdvData = [];
            foreach ($rdv as $rdvItem) {
                $rdvData[] = [
                    'id' => $rdvItem->getId(),
                    'date' => $rdvItem->getDate()->format('Y-m-d H:i:s'), // Format de date personnalisé
                    // Ajoutez d'autres champs de rdv si nécessaire
                ];
            }
    
            return new JsonResponse($rdvData);
        }
        
        
         